# 麥味登智取櫃 — 訂單查詢系統 使用手冊

---

## 1. 系統簡介

「訂單查詢系統」是提供給客服人員使用的線上查詢工具，用來追蹤智取櫃中每一筆訂單的狀態——從店員存入餐點，到顧客取走餐點的完整過程。

當顧客反映取餐問題時，客服人員可以透過這套系統，快速查到訂單目前的進度，判斷問題原因並給予協助。

---

## 2. 畫面總覽

系統共有兩個主要畫面：**訂單清單** 與 **訂單詳情（操作時間軸）**。

---

### 2.1 頂部導航列

頁面最上方的深綠色橫條：

| 位置 | 內容 |
|------|------|
| 左側 | 麥味登 Logo 與「智取櫃系統」字樣 |
| 中間 | 品牌標語「餐餐陪你，溫暖每一天」 |
| 右側 | 目前的日期與時間（自動更新） |

---

### 2.2 訂單查詢區

畫面上方的查詢條件區，可依不同方式搜尋訂單：

| 欄位 | 操作說明 | 預設值 |
|------|----------|--------|
| **店號** | 從下拉選單選擇要查的店家，或選「全部店家」 | 全部店家 |
| **訂單編號** | 直接輸入訂單號碼。**輸入後會直接查這筆訂單，不受其他條件影響** | 空白 |
| **取餐碼** | 輸入顧客的取餐碼 | 空白 |
| **存餐格口** | 選擇格口編號（1～12），或選「全部格口」 | 全部格口 |
| **開始日期 / 時間** | 設定查詢的起始時間 | 7 天前 / 06:00 |
| **結束日期 / 時間** | 設定查詢的結束時間 | 今日 / 23:59 |
| **查詢按鈕** | 點擊開始查詢，也可以在輸入欄位按 Enter 鍵 | — |

> 至少要填寫一個條件才能查詢。

---

### 2.3 查詢結果 — 訂單清單

#### 訂單清單畫面

<!-- IMG:a1.png -->

查詢後會列出符合條件的訂單表格。

**統計列**（表格上方）：

| 標籤 | 意義 |
|------|------|
| 共 N 筆 | 查到的訂單總數 |
| 已取餐 N | 顧客已成功取走餐點的筆數 |
| 未取餐 N | 餐點仍在格口中，或已被取消的筆數 |

**表格各欄位**：

| 欄位 | 說明 |
|------|------|
| **店號** | 該筆訂單所屬的店家 |
| **訂單編號** | 訂單號碼（**可點擊，進入詳細時間軸**） |
| **取餐碼** | 顧客用來開櫃取餐的代碼 |
| **格口** | 餐點存放在哪個格口 |
| **存餐時間** | 店員存入餐點的時間 |
| **取餐時間** | 顧客取走餐點的時間，若尚未取餐顯示「-」 |
| **狀態** | 「已取餐」或「未取餐」 |

---

### 2.4 訂單詳情 — 操作時間軸

點擊訂單編號後，進入該筆訂單的**操作時間軸**。這是本系統最重要的功能——以時間順序呈現這筆訂單從頭到尾發生了什麼事。

#### 操作時間軸畫面

<!-- IMG:a3.png -->

#### 頂部資訊

| 項目 | 說明 |
|------|------|
| 「返回清單」按鈕 | 回到訂單列表 |
| 訂單 #XXXXXXXXXX | 目前檢視的訂單編號 |
| 取餐碼 | 該訂單的取餐碼 |
| 格口 | 餐點存放的格口編號 |

#### 時間軸上的三種事件

時間軸以不同顏色區分事件來源：

| 顏色 | 來源 | 說明 |
|------|------|------|
| **青色** | 存餐機 | 店員端的操作（存入餐點） |
| **珊瑚紅色** | 取餐機 | 顧客端的操作（取走餐點） |
| **橙色** | 格口 | 格口硬體的狀態變化（開門、關門、有無物品） |

#### 每個事件顯示的資訊

- **時間**：精確到秒的事件發生時間
- **事件說明**：以中文描述發生了什麼（如「存餐完成」「取餐完成」等）
- **來源標籤**：顯示是「存餐機」還是「取餐機」
- **時間差**：與下一個事件相隔多久（格式 +時:分:秒）

#### 常見事件說明

| 標記 | 事件 | 意義 |
|------|------|------|
| [存] | 開始存餐 | 店員開始操作存餐機放入餐點 |
| [存] | 存餐中 | 餐點正在放入格口 |
| [存] | 存餐完成 | 餐點已成功存入格口，等待顧客取餐 |
| [取] | 準備取餐 | 顧客輸入取餐碼，核銷成功，格口正在開門 |
| [取] | 取餐完成 | 顧客已取走餐點，格口門已關閉 |
| [刪] | 訂單刪除 | 訂單被取消，格口已清空 |
| [系] | 訂單開始 | 系統收到新訂單 |
| [系] | 讀取輸入 | 偵測到掃碼或輸入動作 |
| [格] | 格口狀態變化 | 格口的門或感測器狀態改變（見下方說明） |

---

## 3. 格口狀態變化說明

格口事件在時間軸中會顯示為類似這樣的格式：

> 格口07 [7 -> 6] 前門關閉

其中：

| 部分 | 意義 |
|------|------|
| 格口07 | 第 7 號格口 |
| [7 -> 6] | 格口狀態值從 7 變成 6 |
| 前門關閉 | 系統自動解讀的狀態變化摘要 |

### 格口可能出現的狀態變化

| 變化描述 | 意義 |
|----------|------|
| **前門開啟** | 顧客側的門打開了（通常是取餐碼核銷後自動開門） |
| **前門關閉** | 顧客側的門關上了（顧客取餐後關門） |
| **後門開啟** | 店員側的門打開了（店員正在放入或取出餐點） |
| **後門關閉** | 店員側的門關上了 |
| **感測有物** | 格口內偵測到有東西（餐點已放入） |
| **感測無物** | 格口內偵測到沒有東西（餐點已被取走或格口已清空） |

---

## 4. 常見情境時間軸範例

### 4.1 正常取餐流程

一筆順利完成的訂單，時間軸會依序出現以下事件：

```
時間        事件                                       來源
--------   -----------------------------------------  --------
10:15:30   [存] 開始存餐                               存餐機
                 | 約 5 秒
10:15:35   [存] 存餐中                                 存餐機
                 | 約 20 秒
10:15:55   [存] 存餐完成                               存餐機
====================================================================
                 | 等待顧客前來取餐（約 1 分 32 秒）
====================================================================
10:17:27   [取] 準備取餐 - 取餐碼核銷成功，格口開門中    取餐機
                 | 約 3 秒
10:17:30   [格] 格口07 前門關閉                         格口
                 | 約 2 秒
10:17:32   [取] 取餐完成 - 格口已關門                   取餐機
```

**解讀**：

1. 店員在 10:15 透過存餐機將餐點放入 7 號格口
2. 顧客在 10:17 輸入取餐碼，格口自動開門
3. 顧客取走餐點後關門，系統確認取餐完成

---

### 4.2 取消訂單

訂單被取消時的時間軸：

```
時間        事件                                       來源
--------   -----------------------------------------  --------
10:15:55   [存] 存餐完成                               存餐機
====================================================================
                 | 長時間未取餐（約 1 小時 30 分）
====================================================================
11:45:55   [刪] 開始刪除                               存餐機
                 | 約 10 秒
11:46:05   [刪] 訂單刪除                               存餐機
```

**解讀**：

1. 餐點存入後長時間無人領取
2. 店員主動或系統自動取消訂單，清空格口
3. 此訂單在清單中顯示為「**未取餐**」，取餐時間欄位顯示「-」

---

### 4.3 格口開關與物品感測的完整變化

一次完整的存餐到取餐過程中，格口的狀態會如何變化：

**存餐階段（店員操作後門）**：

```
時間        格口事件               說明
--------   --------------------   ----------------------
10:15:30   格口07 後門開啟         店員打開後門
10:15:50   格口07 感測有物         餐點放入，感測器偵測到
10:15:55   格口07 後門關閉         店員關上後門
```

**取餐階段（顧客操作前門）**：

```
時間        格口事件               說明
--------   --------------------   ----------------------
10:17:27   格口07 前門開啟         取餐碼核銷，前門自動開啟
10:17:28   格口07 感測無物         顧客取走餐點
10:17:30   格口07 前門關閉         顧客關上前門
```

**重點提醒**：

- **後門** = 店員側（用於存餐或清理）
- **前門** = 顧客側（用於取餐）
- **感測有物** = 格口裡有餐點
- **感測無物** = 格口裡是空的

---

## 5. 操作指南

### 5.1 查詢特定訂單

1. 在「訂單編號」欄位輸入訂單號碼
2. 點擊「查詢」
3. 在結果中點擊訂單編號，查看完整時間軸

### 5.2 用取餐碼查詢

1. 在「取餐碼」欄位輸入顧客提供的取餐碼
2. 可搭配選擇店號縮小範圍
3. 點擊「查詢」

### 5.3 查詢某個格口的使用紀錄

1. 從「存餐格口」下拉選單選擇格口編號
2. 設定日期範圍
3. 點擊「查詢」，可看到該格口的所有訂單歷史

### 5.4 查看某段時間的所有訂單

1. 設定開始日期與時間
2. 設定結束日期與時間
3. 選擇店號（若有多家店）
4. 點擊「查詢」

### 5.5 如何判斷訂單狀態

| 在清單中看到 | 代表 |
|------------|------|
| 狀態「已取餐」、取餐時間有值 | 顧客已成功取走餐點 |
| 狀態「未取餐」、取餐時間為「-」 | 餐點可能還在格口中，或已被取消 |

進入時間軸可以進一步確認：

- 最後一筆是 **取餐完成** → 訂單正常完成
- 最後一筆是 **訂單刪除** → 訂單已被取消
- 只有存餐紀錄，沒有取餐紀錄 → 餐點仍在格口中等待

---

## 6. 常見問題排查

| 顧客反映的問題 | 查詢方式 | 如何判斷 |
|--------------|----------|----------|
| 取餐碼無法使用 | 用取餐碼查詢 | 確認訂單是否存在、是否已被取消 |
| 格口裡沒有餐點 | 用訂單編號查詢，看時間軸 | 查看是否出現「感測無物」，是否已被其他人取走 |
| 格口門打不開 | 查看時間軸中的格口事件 | 若無「前門開啟」事件，可能是硬體問題，需通知維修 |
| 不確定餐點是否已存入 | 用訂單編號查詢 | 時間軸中是否有「存餐完成」事件 |
| 訂單為何被取消 | 用訂單編號查詢，看時間軸 | 查看「訂單刪除」事件的時間與原因 |
